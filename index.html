<!DOCTYPE html>
<html lang="pt-br">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Meu Porquinho Gordinho</title>
    <style>
        /* Estilos Gerais */
        body { 
            font-family: sans-serif; 
            text-align: center; 
            background-color: #f0f2f5; 
            padding: 20px;
            margin: 0;
        }
        
        /* O mostrador de saldo (Cabeçalho) */
        .placar {
            background: #fff;
            padding: 15px; /* Um pouco menos de espaçamento interno para acomodar a imagem */
            border-radius: 15px;
            box-shadow: 0 4px 8px rgba(0,0,0,0.1);
            margin-bottom: 25px;
            position: sticky;
            top: 10px; /* Um pequeno espaço do topo */
            z-index: 100; /* Garante que fique por cima dos números ao rolar */
        }

        /* --- ESTILO DA NOVA IMAGEM --- */
        .img-header {
            max-width: 100%; /* Garante que ela não estoure a tela do celular */
            height: auto;    /* Mantém a proporção correta (não achata o porco) */
            border-radius: 12px; /* Bordas arredondadas para combinar com o cartão */
            margin-bottom: 15px; /* Espaço entre a imagem e o texto */
            display: block;
        }

        /* Textos do placar */
        .placar p { margin: 0; color: #666; font-size: 0.9rem;}
        .total { font-size: 2.2rem; color: #2ecc71; font-weight: 800; margin-top: 5px;}

        /* O Seletor de Desafio */
        #seletorDesafio {
            padding: 10px 15px;
            font-size: 1rem;
            border-radius: 8px;
            border: 1px solid #ccc;
            margin-bottom: 25px;
            background-color: #fff;
            width: 100%;
            max-width: 300px;
        }

        /* A Grade de Números */
        .grid-container {
            display: grid;
            /* Cria colunas automaticamente, com largura mínima de 65px */
            grid-template-columns: repeat(auto-fill, minmax(65px, 1fr)); 
            gap: 12px;
            max-width: 600px; /* Evita que fique muito largo em telas grandes */
            margin: 0 auto; /* Centraliza a grade na tela */
            padding-bottom: 30px;
        }

        .botao-valor {
            background: #e9ecef;
            color: #495057;
            border: none;
            padding: 15px 5px; /* Mais altura, menos largura no padding */
            font-size: 1.1rem;
            font-weight: bold;
            border-radius: 12px;
            cursor: pointer;
            transition: all 0.2s ease;
            box-shadow: 0 2px 4px rgba(0,0,0,0.05);
        }

        .botao-valor:active { transform: scale(0.95); }

        /* Classe para quando o valor for pago */
        .pago {
            background-color: #2ecc71;
            color: white;
            box-shadow: inset 0 2px 4px rgba(0,0,0,0.1); /* Sombra interna para dar profundidade */
        }
    </style>
</head>
<body>

    <div class="placar">
        <img src="cofrinho.png" alt="Cofre de porquinho dourado" class="img-header">
        
        <p>Total Guardado:</p>
        <div class="total" id="displayTotal">R$ 0,00</div>
    </div>

    <select id="seletorDesafio" onchange="mudarDesafioComConfirmacao()">
        <option value="200">Desafio até R$ 200</option>
        <option value="250">Desafio até R$ 250</option>
        <option value="300">Desafio até R$ 300</option>
    </select>

    <div class="grid-container" id="grid">
        </div>

    <script>
        const grid = document.getElementById('grid');
        const displayTotal = document.getElementById('displayTotal');
        const seletor = document.getElementById('seletorDesafio');
        let total = 0;
        
        // Carrega dados salvos ou inicia vazios
        let dadosSalvos = JSON.parse(localStorage.getItem('meuCofre_dados')) || [];
        // Carrega qual foi o último desafio selecionado
        let desafioAtual = localStorage.getItem('meuCofre_desafio') || "200";
        
        // Aplica o desafio salvo ao carregar a página
        seletor.value = desafioAtual;

        function mudarDesafioComConfirmacao() {
            if (dadosSalvos.length > 0) {
                let confirmar = confirm("Atenção: Mudar o desafio agora pode ocultar números que você já marcou. Deseja continuar?");
                if (confirmar) {
                    gerarGrade();
                } else {
                    // Volta o seletor para a opção anterior se a pessoa cancelar
                    seletor.value = desafioAtual; 
                }
            } else {
                gerarGrade();
            }
        }

        function gerarGrade() {
            grid.innerHTML = ''; // Limpa a grade
            const maximo = seletor.value;
            desafioAtual = maximo;
            total = 0; // Reinicia contagem visual para recalcular

            // Salva a escolha do desafio
            localStorage.setItem('meuCofre_desafio', maximo);

            for (let i = 1; i <= maximo; i++) {
                const btn = document.createElement('button');
                btn.innerText = i;
                btn.className = 'botao-valor';
                
                // Verifica se esse número já estava salvo como pago
                if (dadosSalvos.includes(i)) {
                    btn.classList.add('pago');
                    total += i;
                }

                // Evento de clique
                btn.onclick = function() {
                    if (btn.classList.contains('pago')) {
                        // Remover pagamento
                        btn.classList.remove('pago');
                        total -= i;
                        dadosSalvos = dadosSalvos.filter(item => item !== i);
                    } else {
                        // Adicionar pagamento
                        btn.classList.add('pago');
                        total += i;
                        dadosSalvos.push(i);
                    }
                    atualizarTela();
                };

                grid.appendChild(btn);
            }
            atualizarTela();
        }

        function atualizarTela() {
            displayTotal.innerText = total.toLocaleString('pt-BR', { style: 'currency', currency: 'BRL' });
            // Salva os números marcados
            localStorage.setItem('meuCofre_dados', JSON.stringify(dadosSalvos));
        }

        // Inicia o app
        gerarGrade();
    </script>
</body>
</html>
